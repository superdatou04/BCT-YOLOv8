Ultralytics YOLOv8.1.9 🚀 Python-3.8.10 torch-1.9.0+cu111 CUDA:0 (NVIDIA GeForce RTX 3090, 24268MiB)
WARNING ⚠️ Upgrade to torch>=2.0.0 for deterministic training.
[34m[1mmodels/yolo/detect/distill: [0mtask=detect, mode=train, model=/root/autodl-tmp/v8-cl/old.pt, data=dataset/new.yaml, epochs=300, time=None, patience=50, batch=24, imgsz=640, save=True, save_period=-1, cache=True, device=0, workers=8, project=runs/distill, name=mgd-bckd2, exist_ok=False, pretrained=True, optimizer=SGD, verbose=True, seed=0, deterministic=True, single_cls=False, rect=False, cos_lr=False, close_mosaic=20, resume=False, amp=True, fraction=1.0, profile=False, freeze=None, multi_scale=False, overlap_mask=True, mask_ratio=4, dropout=0.0, val=True, split=val, save_json=False, save_hybrid=False, conf=None, iou=0.7, max_det=300, half=False, dnn=False, plots=True, source=None, vid_stride=1, stream_buffer=False, visualize=False, augment=False, agnostic_nms=False, classes=None, retina_masks=False, embed=None, show=False, save_frames=False, save_txt=False, save_conf=False, save_crop=False, show_labels=True, show_conf=True, show_boxes=True, line_width=None, format=torchscript, keras=False, optimize=False, int8=False, dynamic=False, simplify=False, opset=None, workspace=4, nms=False, lr0=0.01, lrf=0.01, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=7.5, cls=0.5, dfl=1.5, pose=12.0, kobj=1.0, label_smoothing=0.0, nbs=64, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, mosaic=1.0, mixup=0.0, copy_paste=0.0, auto_augment=randaugment, erasing=0.4, crop_fraction=1.0, cfg=None, tracker=botsort.yaml, prune_model=False, teacher_weights=/root/autodl-tmp/v8-cl/old.pt, teacher_cfg=ultralytics/cfg/models/v8/yolov8l.yaml, kd_loss_type=all, kd_loss_decay=constant, logical_loss_type=BCKD, logical_loss_ratio=1.0, teacher_kd_layers=15,18,21, student_kd_layers=15,18,21, feature_loss_type=cwd, feature_loss_ratio=1.0, save_dir=runs/distill/mgd-bckd2
[34m[1mSetUp Student Model:[0m
Overriding model.yaml nc=24 with nc=25

                   from  n    params  module                                       arguments                     
  0                  -1  1      1856  ultralytics.nn.modules.conv.Conv             [3, 64, 3, 2]                 
  1                  -1  1     73984  ultralytics.nn.modules.conv.Conv             [64, 128, 3, 2]               
  2                  -1  3    279808  ultralytics.nn.modules.block.C2f             [128, 128, 3, True]           
  3                  -1  1    295424  ultralytics.nn.modules.conv.Conv             [128, 256, 3, 2]              
  4                  -1  6   2101248  ultralytics.nn.modules.block.C2f             [256, 256, 6, True]           
  5                  -1  1   1180672  ultralytics.nn.modules.conv.Conv             [256, 512, 3, 2]              
  6                  -1  6   8396800  ultralytics.nn.modules.block.C2f             [512, 512, 6, True]           
  7                  -1  1   2360320  ultralytics.nn.modules.conv.Conv             [512, 512, 3, 2]              
  8                  -1  3   4461568  ultralytics.nn.modules.block.C2f             [512, 512, 3, True]           
  9                  -1  1    656896  ultralytics.nn.modules.block.SPPF            [512, 512, 5]                 
 10                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']          
 11             [-1, 6]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 12                  -1  3   4723712  ultralytics.nn.modules.block.C2f             [1024, 512, 3]                
 13                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']          
 14             [-1, 4]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 15                  -1  3   1247744  ultralytics.nn.modules.block.C2f             [768, 256, 3]                 
 16                  -1  1    590336  ultralytics.nn.modules.conv.Conv             [256, 256, 3, 2]              
 17            [-1, 12]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 18                  -1  3   4592640  ultralytics.nn.modules.block.C2f             [768, 512, 3]                 
 19                  -1  1   2360320  ultralytics.nn.modules.conv.Conv             [512, 512, 3, 2]              
 20             [-1, 9]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 21                  -1  3   4723712  ultralytics.nn.modules.block.C2f             [1024, 512, 3]                
 22        [15, 18, 21]  1   5602075  ultralytics.nn.modules.head.Detect           [25, [256, 512, 512]]         
YOLOv8l summary: 365 layers, 43649115 parameters, 43649099 gradients, 165.5 GFLOPs

[34m[1mSetUp Teacher Model:[0m
Overriding model.yaml nc=24 with nc=25

                   from  n    params  module                                       arguments                     
  0                  -1  1      1856  ultralytics.nn.modules.conv.Conv             [3, 64, 3, 2]                 
  1                  -1  1     73984  ultralytics.nn.modules.conv.Conv             [64, 128, 3, 2]               
  2                  -1  3    279808  ultralytics.nn.modules.block.C2f             [128, 128, 3, True]           
  3                  -1  1    295424  ultralytics.nn.modules.conv.Conv             [128, 256, 3, 2]              
  4                  -1  6   2101248  ultralytics.nn.modules.block.C2f             [256, 256, 6, True]           
  5                  -1  1   1180672  ultralytics.nn.modules.conv.Conv             [256, 512, 3, 2]              
  6                  -1  6   8396800  ultralytics.nn.modules.block.C2f             [512, 512, 6, True]           
  7                  -1  1   2360320  ultralytics.nn.modules.conv.Conv             [512, 512, 3, 2]              
  8                  -1  3   4461568  ultralytics.nn.modules.block.C2f             [512, 512, 3, True]           
  9                  -1  1    656896  ultralytics.nn.modules.block.SPPF            [512, 512, 5]                 
 10                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']          
 11             [-1, 6]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 12                  -1  3   4723712  ultralytics.nn.modules.block.C2f             [1024, 512, 3]                
 13                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']          
 14             [-1, 4]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 15                  -1  3   1247744  ultralytics.nn.modules.block.C2f             [768, 256, 3]                 
 16                  -1  1    590336  ultralytics.nn.modules.conv.Conv             [256, 256, 3, 2]              
 17            [-1, 12]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 18                  -1  3   4592640  ultralytics.nn.modules.block.C2f             [768, 512, 3]                 
 19                  -1  1   2360320  ultralytics.nn.modules.conv.Conv             [512, 512, 3, 2]              
 20             [-1, 9]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 21                  -1  3   4723712  ultralytics.nn.modules.block.C2f             [1024, 512, 3]                
 22        [15, 18, 21]  1   5602075  ultralytics.nn.modules.head.Detect           [25, [256, 512, 512]]         
YOLOv8l summary: 365 layers, 43649115 parameters, 43649099 gradients, 165.5 GFLOPs

Transferred 589/595 items from pretrained weights
Freezing layer 'model.22.dfl.conv.weight'
[34m[1mAMP: [0mrunning Automatic Mixed Precision (AMP) checks with YOLOv8n...
[34m[1mAMP: [0mchecks passed ✅
[34m[1mtrain: [0mScanning /root/autodl-tmp/v8-cl/dataset/newdata/labels/train.cache... 1893 images, 0 backgrounds, 0 corrupt: 100%|██████████| 1893/1893 [00:00<?, ?it/s][0m[34m[1mtrain: [0mScanning /root/autodl-tmp/v8-cl/dataset/newdata/labels/train.cache... 1893 images, 0 backgrounds, 0 corrupt: 100%|██████████| 1893/1893 [00:00<?, ?it/s][0m
  0%|          | 0/1893 [00:00<?, ?it/s][34m[1mtrain: [0mCaching images (0.1GB True):   6%|▌         | 106/1893 [00:00<00:01, 1055.69it/s][0m[34m[1mtrain: [0mCaching images (0.2GB True):  12%|█▏        | 227/1893 [00:00<00:01, 1140.04it/s][0m[34m[1mtrain: [0mCaching images (0.3GB True):  19%|█▉        | 362/1893 [00:00<00:01, 1234.91it/s][0m[34m[1mtrain: [0mCaching images (0.4GB True):  26%|██▌       | 494/1893 [00:00<00:01, 1267.05it/s][0m[34m[1mtrain: [0mCaching images (0.5GB True):  33%|███▎      | 629/1893 [00:00<00:00, 1288.99it/s][0m[34m[1mtrain: [0mCaching images (0.7GB True):  40%|████      | 758/1893 [00:00<00:00, 1261.37it/s][0m[34m[1mtrain: [0mCaching images (0.8GB True):  47%|████▋     | 885/1893 [00:00<00:00, 1239.21it/s][0m[34m[1mtrain: [0mCaching images (0.9GB True):  53%|█████▎    | 1010/1893 [00:00<00:00, 1217.27it/s][0m[34m[1mtrain: [0mCaching images (1.0GB True):  60%|█████▉    | 1132/1893 [00:00<00:00, 1193.34it/s][0m[34m[1mtrain: [0mCaching images (1.1GB True):  66%|██████▌   | 1252/1893 [00:01<00:00, 1195.10it/s][0m[34m[1mtrain: [0mCaching images (1.2GB True):  73%|███████▎  | 1379/1893 [00:01<00:00, 1215.48it/s][0m[34m[1mtrain: [0mCaching images (1.3GB True):  80%|███████▉  | 1507/1893 [00:01<00:00, 1228.04it/s][0m[34m[1mtrain: [0mCaching images (1.4GB True):  86%|████████▌ | 1631/1893 [00:01<00:00, 1230.75it/s][0m[34m[1mtrain: [0mCaching images (1.5GB True):  93%|█████████▎| 1763/1893 [00:01<00:00, 1255.87it/s][0m[34m[1mtrain: [0mCaching images (1.6GB True): 100%|█████████▉| 1890/1893 [00:01<00:00, 1252.80it/s][0m[34m[1mtrain: [0mCaching images (1.6GB True): 100%|██████████| 1893/1893 [00:01<00:00, 1232.50it/s][0m
[34m[1mval: [0mScanning /root/autodl-tmp/v8-cl/dataset/pest/labels/val.cache... 2207 images, 143 backgrounds, 2 corrupt: 100%|██████████| 2207/2207 [00:00<?, ?it/s][0m[34m[1mval: [0mScanning /root/autodl-tmp/v8-cl/dataset/pest/labels/val.cache... 2207 images, 143 backgrounds, 2 corrupt: 100%|██████████| 2207/2207 [00:00<?, ?it/s][0m[34m[1mval: [0mWARNING ⚠️ /root/autodl-tmp/v8-cl/dataset/pest/images/val/192.168.1.64_01_20210829215020494_ALARM_INPUT.jpg: ignoring corrupt image/label: non-normalized or out of bounds coordinates [     1.0015]
[34m[1mval: [0mWARNING ⚠️ /root/autodl-tmp/v8-cl/dataset/pest/images/val/20210722015705.jpg: ignoring corrupt image/label: non-normalized or out of bounds coordinates [     1.0107]

  0%|          | 0/2205 [00:00<?, ?it/s][34m[1mval: [0mCaching images (0.0GB True):   0%|          | 1/2205 [00:00<06:31,  5.63it/s][0m[34m[1mval: [0mCaching images (0.2GB True):  10%|▉         | 219/2205 [00:00<00:02, 974.23it/s][0m[34m[1mval: [0mCaching images (0.3GB True):  16%|█▌        | 348/2205 [00:00<00:02, 890.97it/s][0m[34m[1mval: [0mCaching images (0.4GB True):  21%|██        | 455/2205 [00:00<00:01, 908.56it/s][0m[34m[1mval: [0mCaching images (0.5GB True):  25%|██▌       | 557/2205 [00:00<00:02, 751.07it/s][0m[34m[1mval: [0mCaching images (0.6GB True):  29%|██▉       | 642/2205 [00:00<00:02, 654.90it/s][0m[34m[1mval: [0mCaching images (0.6GB True):  32%|███▏      | 716/2205 [00:01<00:02, 672.46it/s][0m[34m[1mval: [0mCaching images (0.7GB True):  36%|███▌      | 789/2205 [00:01<00:03, 419.42it/s][0m[34m[1mval: [0mCaching images (0.7GB True):  38%|███▊      | 846/2205 [00:02<00:07, 172.46it/s][0m[34m[1mval: [0mCaching images (0.8GB True):  40%|████      | 887/2205 [00:02<00:09, 133.52it/s][0m[34m[1mval: [0mCaching images (0.8GB True):  42%|████▏     | 918/2205 [00:03<00:11, 112.82it/s][0m[34m[1mval: [0mCaching images (0.8GB True):  43%|████▎     | 941/2205 [00:03<00:12, 105.15it/s][0m[34m[1mval: [0mCaching images (0.9GB True):  44%|████▎     | 960/2205 [00:03<00:12, 103.59it/s][0m[34m[1mval: [0mCaching images (0.9GB True):  44%|████▍     | 976/2205 [00:04<00:12, 101.14it/s][0m[34m[1mval: [0mCaching images (0.9GB True):  45%|████▍     | 990/2205 [00:04<00:12, 95.56it/s][0m [34m[1mval: [0mCaching images (0.9GB True):  45%|████▌     | 1003/2205 [00:04<00:12, 99.53it/s][0m[34m[1mval: [0mCaching images (0.9GB True):  46%|████▌     | 1015/2205 [00:04<00:12, 93.40it/s][0m[34m[1mval: [0mCaching images (0.9GB True):  47%|████▋     | 1026/2205 [00:04<00:12, 94.10it/s][0m[34m[1mval: [0mCaching images (0.9GB True):  47%|████▋     | 1037/2205 [00:04<00:13, 84.79it/s][0m[34m[1mval: [0mCaching images (0.9GB True):  48%|████▊     | 1049/2205 [00:04<00:12, 91.39it/s][0m[34m[1mval: [0mCaching images (1.0GB True):  48%|████▊     | 1059/2205 [00:05<00:12, 92.39it/s][0m[34m[1mval: [0mCaching images (1.0GB True):  48%|████▊     | 1069/2205 [00:05<00:13, 81.61it/s][0m[34m[1mval: [0mCaching images (1.0GB True):  49%|████▉     | 1082/2205 [00:05<00:12, 89.97it/s][0m[34m[1mval: [0mCaching images (1.0GB True):  50%|████▉     | 1092/2205 [00:05<00:13, 85.41it/s][0m[34m[1mval: [0mCaching images (1.0GB True):  50%|████▉     | 1101/2205 [00:05<00:12, 85.41it/s][0m[34m[1mval: [0mCaching images (1.0GB True):  50%|█████     | 1112/2205 [00:05<00:11, 91.48it/s][0m[34m[1mval: [0mCaching images (1.0GB True):  51%|█████     | 1122/2205 [00:05<00:11, 91.90it/s][0m[34m[1mval: [0mCaching images (1.0GB True):  51%|█████▏    | 1132/2205 [00:05<00:12, 87.02it/s][0m[34m[1mval: [0mCaching images (1.1GB True):  52%|█████▏    | 1141/2205 [00:06<00:13, 80.23it/s][0m[34m[1mval: [0mCaching images (1.1GB True):  52%|█████▏    | 1152/2205 [00:06<00:12, 86.36it/s][0m[34m[1mval: [0mCaching images (1.1GB True):  53%|█████▎    | 1161/2205 [00:06<00:12, 84.48it/s][0m[34m[1mval: [0mCaching images (1.1GB True):  53%|█████▎    | 1170/2205 [00:06<00:12, 83.90it/s][0m[34m[1mval: [0mCaching images (1.1GB True):  54%|█████▎    | 1181/2205 [00:06<00:11, 88.66it/s][0m[34m[1mval: [0mCaching images (1.1GB True):  54%|█████▍    | 1190/2205 [00:06<00:12, 83.97it/s][0m[34m[1mval: [0mCaching images (1.1GB True):  54%|█████▍    | 1199/2205 [00:06<00:11, 84.59it/s][0m[34m[1mval: [0mCaching images (1.1GB True):  55%|█████▍    | 1208/2205 [00:06<00:11, 83.72it/s][0m[34m[1mval: [0mCaching images (1.1GB True):  55%|█████▌    | 1217/2205 [00:06<00:11, 83.25it/s][0m[34m[1mval: [0mCaching images (1.2GB True):  56%|█████▌    | 1228/2205 [00:07<00:10, 89.55it/s][0m[34m[1mval: [0mCaching images (1.2GB True):  56%|█████▌    | 1238/2205 [00:07<00:10, 89.21it/s][0m[34m[1mval: [0mCaching images (1.2GB True):  57%|█████▋    | 1247/2205 [00:07<00:11, 85.48it/s][0m[34m[1mval: [0mCaching images (1.2GB True):  57%|█████▋    | 1256/2205 [00:07<00:11, 83.68it/s][0m[34m[1mval: [0mCaching images (1.2GB True):  57%|█████▋    | 1265/2205 [00:07<00:11, 84.89it/s][0m[34m[1mval: [0mCaching images (1.2GB True):  58%|█████▊    | 1274/2205 [00:07<00:11, 84.06it/s][0m[34m[1mval: [0mCaching images (1.2GB True):  58%|█████▊    | 1283/2205 [00:07<00:10, 85.53it/s][0m[34m[1mval: [0mCaching images (1.2GB True):  59%|█████▊    | 1293/2205 [00:07<00:10, 89.03it/s][0m[34m[1mval: [0mCaching images (1.2GB True):  59%|█████▉    | 1304/2205 [00:07<00:10, 82.79it/s][0m[34m[1mval: [0mCaching images (1.2GB True):  60%|█████▉    | 1316/2205 [00:08<00:09, 91.80it/s][0m[34m[1mval: [0mCaching images (1.3GB True):  60%|██████    | 1326/2205 [00:08<00:09, 93.02it/s][0m[34m[1mval: [0mCaching images (1.3GB True):  61%|██████    | 1336/2205 [00:08<00:10, 86.44it/s][0m[34m[1mval: [0mCaching images (1.3GB True):  61%|██████    | 1347/2205 [00:08<00:09, 91.00it/s][0m[34m[1mval: [0mCaching images (1.3GB True):  62%|██████▏   | 1358/2205 [00:08<00:08, 95.85it/s][0m[34m[1mval: [0mCaching images (1.3GB True):  62%|██████▏   | 1368/2205 [00:08<00:09, 85.22it/s][0m[34m[1mval: [0mCaching images (1.3GB True):  62%|██████▏   | 1378/2205 [00:08<00:09, 88.97it/s][0m[34m[1mval: [0mCaching images (1.3GB True):  63%|██████▎   | 1388/2205 [00:08<00:08, 91.80it/s][0m[34m[1mval: [0mCaching images (1.3GB True):  63%|██████▎   | 1398/2205 [00:08<00:08, 92.87it/s][0m[34m[1mval: [0mCaching images (1.4GB True):  64%|██████▍   | 1408/2205 [00:09<00:09, 85.84it/s][0m[34m[1mval: [0mCaching images (1.4GB True):  65%|██████▍   | 1427/2205 [00:09<00:06, 112.00it/s][0m[34m[1mval: [0mCaching images (1.4GB True):  65%|██████▌   | 1444/2205 [00:09<00:06, 126.07it/s][0m[34m[1mval: [0mCaching images (1.4GB True):  66%|██████▋   | 1462/2205 [00:09<00:05, 139.61it/s][0m[34m[1mval: [0mCaching images (1.4GB True):  67%|██████▋   | 1478/2205 [00:09<00:05, 124.23it/s][0m[34m[1mval: [0mCaching images (1.4GB True):  68%|██████▊   | 1491/2205 [00:09<00:06, 110.86it/s][0m[34m[1mval: [0mCaching images (1.5GB True):  68%|██████▊   | 1503/2205 [00:09<00:07, 95.56it/s][0m [34m[1mval: [0mCaching images (1.5GB True):  69%|██████▊   | 1514/2205 [00:10<00:07, 88.20it/s][0m[34m[1mval: [0mCaching images (1.5GB True):  69%|██████▉   | 1524/2205 [00:10<00:07, 86.80it/s][0m[34m[1mval: [0mCaching images (1.5GB True):  70%|██████▉   | 1533/2205 [00:10<00:07, 85.44it/s][0m[34m[1mval: [0mCaching images (1.5GB True):  70%|██████▉   | 1542/2205 [00:10<00:08, 78.87it/s][0m[34m[1mval: [0mCaching images (1.5GB True):  70%|███████   | 1551/2205 [00:10<00:08, 79.15it/s][0m[34m[1mval: [0mCaching images (1.5GB True):  71%|███████   | 1563/2205 [00:10<00:07, 82.72it/s][0m[34m[1mval: [0mCaching images (1.5GB True):  71%|███████▏  | 1573/2205 [00:10<00:07, 80.85it/s][0m[34m[1mval: [0mCaching images (1.5GB True):  72%|███████▏  | 1582/2205 [00:10<00:07, 82.19it/s][0m[34m[1mval: [0mCaching images (1.6GB True):  72%|███████▏  | 1591/2205 [00:11<00:08, 72.24it/s][0m[34m[1mval: [0mCaching images (1.6GB True):  73%|███████▎  | 1601/2205 [00:11<00:07, 78.17it/s][0m[34m[1mval: [0mCaching images (1.6GB True):  73%|███████▎  | 1610/2205 [00:11<00:07, 80.04it/s][0m[34m[1mval: [0mCaching images (1.6GB True):  73%|███████▎  | 1619/2205 [00:11<00:07, 82.17it/s][0m[34m[1mval: [0mCaching images (1.6GB True):  74%|███████▍  | 1628/2205 [00:11<00:07, 79.85it/s][0m[34m[1mval: [0mCaching images (1.6GB True):  74%|███████▍  | 1637/2205 [00:11<00:07, 76.71it/s][0m[34m[1mval: [0mCaching images (1.6GB True):  75%|███████▍  | 1645/2205 [00:11<00:07, 76.48it/s][0m[34m[1mval: [0mCaching images (1.6GB True):  75%|███████▌  | 1654/2205 [00:11<00:07, 78.41it/s][0m[34m[1mval: [0mCaching images (1.6GB True):  75%|███████▌  | 1662/2205 [00:11<00:06, 78.72it/s][0m[34m[1mval: [0mCaching images (1.6GB True):  76%|███████▌  | 1670/2205 [00:12<00:07, 75.69it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  76%|███████▌  | 1678/2205 [00:12<00:06, 76.58it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  77%|███████▋  | 1687/2205 [00:12<00:06, 79.37it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  77%|███████▋  | 1696/2205 [00:12<00:06, 79.19it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  77%|███████▋  | 1704/2205 [00:12<00:06, 75.08it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  78%|███████▊  | 1714/2205 [00:12<00:06, 79.40it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  78%|███████▊  | 1722/2205 [00:12<00:06, 74.06it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  78%|███████▊  | 1730/2205 [00:12<00:06, 74.04it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  79%|███████▉  | 1738/2205 [00:12<00:06, 73.55it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  79%|███████▉  | 1746/2205 [00:13<00:06, 71.20it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  80%|███████▉  | 1754/2205 [00:13<00:06, 71.22it/s][0m[34m[1mval: [0mCaching images (1.7GB True):  80%|███████▉  | 1762/2205 [00:13<00:06, 73.41it/s][0m[34m[1mval: [0mCaching images (1.8GB True):  80%|████████  | 1771/2205 [00:13<00:05, 75.49it/s][0m[34m[1mval: [0mCaching images (1.8GB True):  81%|████████  | 1779/2205 [00:13<00:05, 73.83it/s][0m[34m[1mval: [0mCaching images (1.8GB True):  81%|████████  | 1787/2205 [00:13<00:05, 72.38it/s][0m[34m[1mval: [0mCaching images (1.8GB True):  81%|████████▏ | 1796/2205 [00:13<00:05, 75.92it/s][0m[34m[1mval: [0mCaching images (1.8GB True):  82%|████████▏ | 1805/2205 [00:13<00:05, 77.26it/s][0m[34m[1mval: [0mCaching images (1.8GB True):  82%|████████▏ | 1813/2205 [00:13<00:05, 77.70it/s][0m[34m[1mval: [0mCaching images (1.8GB True):  83%|████████▎ | 1821/2205 [00:14<00:04, 76.84it/s][0m[34m[1mval: [0mCaching images (1.8GB True):  83%|████████▎ | 1831/2205 [00:14<00:04, 83.17it/s][0m[34m[1mval: [0mCaching images (1.8GB True):  83%|████████▎ | 1840/2205 [00:14<00:04, 83.80it/s][0m[34m[1mval: [0mCaching images (1.8GB True):  84%|████████▍ | 1849/2205 [00:14<00:05, 66.91it/s][0m[34m[1mval: [0mCaching images (1.9GB True):  85%|████████▍ | 1864/2205 [00:14<00:04, 84.45it/s][0m[34m[1mval: [0mCaching images (1.9GB True):  85%|████████▍ | 1874/2205 [00:14<00:04, 74.45it/s][0m[34m[1mval: [0mCaching images (1.9GB True):  86%|████████▌ | 1887/2205 [00:14<00:03, 84.36it/s][0m[34m[1mval: [0mCaching images (1.9GB True):  86%|████████▌ | 1897/2205 [00:14<00:03, 81.64it/s][0m[34m[1mval: [0mCaching images (1.9GB True):  86%|████████▋ | 1906/2205 [00:15<00:03, 81.55it/s][0m[34m[1mval: [0mCaching images (1.9GB True):  87%|████████▋ | 1916/2205 [00:15<00:03, 82.96it/s][0m[34m[1mval: [0mCaching images (1.9GB True):  87%|████████▋ | 1926/2205 [00:15<00:03, 86.72it/s][0m[34m[1mval: [0mCaching images (1.9GB True):  88%|████████▊ | 1936/2205 [00:15<00:03, 84.35it/s][0m[34m[1mval: [0mCaching images (1.9GB True):  88%|████████▊ | 1945/2205 [00:15<00:03, 84.44it/s][0m[34m[1mval: [0mCaching images (2.0GB True):  89%|████████▊ | 1955/2205 [00:15<00:02, 86.14it/s][0m[34m[1mval: [0mCaching images (2.0GB True):  89%|████████▉ | 1964/2205 [00:15<00:02, 85.03it/s][0m[34m[1mval: [0mCaching images (2.0GB True):  90%|████████▉ | 1974/2205 [00:15<00:02, 87.06it/s][0m[34m[1mval: [0mCaching images (2.0GB True):  90%|████████▉ | 1983/2205 [00:16<00:02, 84.81it/s][0m[34m[1mval: [0mCaching images (2.0GB True):  90%|█████████ | 1992/2205 [00:16<00:02, 84.23it/s][0m[34m[1mval: [0mCaching images (2.0GB True):  91%|█████████ | 2002/2205 [00:16<00:02, 79.94it/s][0m[34m[1mval: [0mCaching images (2.0GB True):  91%|█████████ | 2011/2205 [00:16<00:02, 80.55it/s][0m[34m[1mval: [0mCaching images (2.0GB True):  92%|█████████▏| 2025/2205 [00:16<00:01, 90.45it/s][0m[34m[1mval: [0mCaching images (2.0GB True):  92%|█████████▏| 2035/2205 [00:16<00:01, 86.71it/s][0m[34m[1mval: [0mCaching images (2.0GB True):  93%|█████████▎| 2044/2205 [00:16<00:01, 86.42it/s][0m[34m[1mval: [0mCaching images (2.1GB True):  93%|█████████▎| 2054/2205 [00:16<00:01, 87.81it/s][0m[34m[1mval: [0mCaching images (2.1GB True):  94%|█████████▎| 2063/2205 [00:16<00:01, 80.07it/s][0m[34m[1mval: [0mCaching images (2.1GB True):  94%|█████████▍| 2073/2205 [00:17<00:01, 81.50it/s][0m[34m[1mval: [0mCaching images (2.1GB True):  94%|█████████▍| 2083/2205 [00:17<00:01, 85.43it/s][0m[34m[1mval: [0mCaching images (2.1GB True):  95%|█████████▍| 2093/2205 [00:17<00:01, 88.25it/s][0m[34m[1mval: [0mCaching images (2.1GB True):  95%|█████████▌| 2103/2205 [00:17<00:01, 90.88it/s][0m[34m[1mval: [0mCaching images (2.1GB True):  96%|█████████▌| 2113/2205 [00:17<00:01, 86.88it/s][0m[34m[1mval: [0mCaching images (2.1GB True):  96%|█████████▋| 2123/2205 [00:17<00:00, 89.18it/s][0m[34m[1mval: [0mCaching images (2.1GB True):  97%|█████████▋| 2132/2205 [00:17<00:00, 89.05it/s][0m[34m[1mval: [0mCaching images (2.1GB True):  97%|█████████▋| 2141/2205 [00:17<00:00, 88.08it/s][0m[34m[1mval: [0mCaching images (2.2GB True):  98%|█████████▊| 2151/2205 [00:17<00:00, 88.07it/s][0m[34m[1mval: [0mCaching images (2.2GB True):  98%|█████████▊| 2160/2205 [00:18<00:00, 84.33it/s][0m[34m[1mval: [0mCaching images (2.2GB True):  98%|█████████▊| 2169/2205 [00:18<00:00, 85.24it/s][0m[34m[1mval: [0mCaching images (2.2GB True):  99%|█████████▉| 2179/2205 [00:18<00:00, 88.24it/s][0m[34m[1mval: [0mCaching images (2.2GB True):  99%|█████████▉| 2189/2205 [00:18<00:00, 88.01it/s][0m[34m[1mval: [0mCaching images (2.2GB True): 100%|██████████| 2205/2205 [00:18<00:00, 119.52it/s][0m
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Plotting labels to runs/distill/mgd-bckd2/labels.jpg... 
[34m[1moptimizer:[0m SGD(lr=0.01, momentum=0.937) with parameter groups 97 weight(decay=0.0), 104 weight(decay=0.0005625000000000001), 103 bias(decay=0.0)
Image sizes 640 train, 640 val
Using 8 dataloader workers
Logging results to [1mruns/distill/mgd-bckd2[0m
Starting training for 300 epochs...

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss   log_loss   fea_loss  Instances       Size
  0%|          | 0/79 [00:00<?, ?it/s]  0%|          | 0/79 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "distill.py", line 45, in <module>
    model.distill()
  File "/root/autodl-tmp/v8-cl/ultralytics/models/yolo/detect/distill.py", line 647, in distill
    self.train()
  File "/root/autodl-tmp/v8-cl/ultralytics/engine/trainer.py", line 209, in train
    self._do_train(world_size)
  File "/root/autodl-tmp/v8-cl/ultralytics/models/yolo/detect/distill.py", line 565, in _do_train
    self.scaler.scale(self.loss).backward()
  File "/root/miniconda3/lib/python3.8/site-packages/torch/_tensor.py", line 255, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/root/miniconda3/lib/python3.8/site-packages/torch/autograd/__init__.py", line 147, in backward
    Variable._execution_engine.run_backward(
RuntimeError: expected scalar type Half but found Float
Ultralytics YOLOv8.1.9 🚀 Python-3.8.10 torch-2.3.0+cu121 
Traceback (most recent call last):
  File "distill.py", line 41, in <module>
    model = DetectionDistiller(overrides=param_dict)
  File "/root/autodl-tmp/v8-cl/ultralytics/models/yolo/detect/distill.py", line 73, in __init__
    self.device = select_device(self.args.device, self.args.batch)
  File "/root/autodl-tmp/v8-cl/ultralytics/utils/torch_utils.py", line 128, in select_device
    raise ValueError(
ValueError: Invalid CUDA 'device=0' requested. Use 'device=cpu' or pass valid CUDA device(s) if available, i.e. 'device=0' or 'device=0,1,2,3' for Multi-GPU.

torch.cuda.is_available(): False
torch.cuda.device_count(): 1
os.environ['CUDA_VISIBLE_DEVICES']: 0

